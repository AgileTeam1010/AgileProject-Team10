<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CatCulation</title>
  <link rel="stylesheet" href="../style.css">
  <link href="https://fonts.googleapis.com/css2?family=Irish+Grover&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Love+Ya+Like+A+Sister&display=swap" rel="stylesheet">
  <script src="../API.js"></script>
  <script src="../levelButton.js"></script>
  <script src="../search.js"></script>
  <script type="module" src="../authState.js"></script>
</head>

<body>
  <header class="top-header">
    <div class="left-header">
      <a href="mixed.html">
        <input type="image" src="../pictures/computercat.png" class="btTxt submit" id="saveForm" />
      </a>
      <h1>CatCulation</h1>
    </div>
    <div class="right-header">
      <a href="/aboutUs.html" class="righttablink">About us</a>
      <div class="search-box">
        <button class="search-icon">üîç</button>
        <input type="search" id="siteSearch" placeholder="Search...">
      </div>
      <a href="../indexlogin.html" class="signinbtn">Sign In / Register</a>
    </div>
  </header>

  <!-- data-operator="mixed" -->
  <div class="content" id="gameRoot" data-operator="mixed">
    <aside class="side-left">
      <a href="mixed.html" class="arrow">‚Üê</a>
      <h2>Mixed Math</h2>
      <a class="level" data-level="1" href="#?level=1">Level 1</a>
      <a class="level" data-level="2" href="#?level=2">Level 2</a>
      <a class="level" data-level="3" href="#?level=3">Level 3</a>
      <a class="level" data-level="4" href="#?level=4">Level 4</a>
      <a class="level" data-level="5" href="#?level=5">Level 5</a>
    </aside>

    <main>
      <div id="progressDisplay"></div>
      <div class="level-box">
        <div class="container">
          <p id="question">Press "New Question" to start!</p>

          <div class="first"></div>
          <div class="second">
            <div class="plus">?</div>
            <div class="number"></div>
          </div>
          <div class="third">
            <div class="line"></div>
            <input type="text" id="userAnswer" placeholder="Your answer">
            <div class="result"></div>
          </div>

          <div class="buttons">
            <button onclick="checkAnswer()">Submit</button>
            <button onclick="newQuestion()">New Question</button>
          </div>
        </div>
      </div>

      <div class="cat-speech-container">
        <div class="catLVL-container">
          <img src="../pictures/cat.png" class="no-click" alt="Cat">
        </div>
        <div class="speechBubble-container">
          <p id="feedback">Let's get started!</p>
          <img src="../pictures/speech-bubble-light-grey.svg" alt="">
        </div>
      </div>
    </main>

    <aside class="side-right">
      <img src="../pictures/advertisement.webp" alt="">
    </aside>
  </div>
</body>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBHVFExyz8RcEy_hWTSvtQYPx7rbZbzUjI",
      authDomain: "agileproject-team10.firebaseapp.com",
      projectId: "agileproject-team10",
      storageBucket: "agileproject-team10.firebasestorage.app",
      messagingSenderId: "949551209474",
      appId: "1:949551209474:web:aa44cf129ea8675e841b1b",
      measurementId: "G-MQQDX82E7M"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Update the header link text/href based on auth state. This keeps the user
    // experience consistent across pages so the Sign In link becomes Profile when logged in.
    onAuthStateChanged(auth, (user) => {
      const btn = document.querySelector('.signinbtn');
      if (!btn) return;
      if (user) {
        btn.textContent = 'Profile';
        btn.href = '../profile.html';
      } else {
        btn.textContent = 'Sign In / Register';
        btn.href = 'indexlogin.html';
      }
    });
  </script>
</html>
